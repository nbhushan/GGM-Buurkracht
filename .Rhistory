)
range(buur.pc.stable)
sum(as.logical(buur.pc.stable))
buur.CCN.PC.stable.qgraph <-
qgraph(
buur.pc.stable,
layout = "spring",
labels = TRUE,
nodeNames = gsub("_", " ", colnames(Scales)),
legend.cex = 0.3,
groups = buur_groups,
palette = "ggplot2",
legend = TRUE,
legend.mode = "style1",
legend.cex = 0.32,
vsize = 3.8,
edge.labels = FALSE,
edge.label.cex = 0.4,
edge.label.bg = TRUE,
edge.label.position = 0.5,
weighted = FALSE,
layoutOffset = c(-.2, 0),
#GLratio=1.0,
filename = "buurPC_stabilitySelection2",
filetype = "pdf"
#minimum = 0.9
)
buur.lingam.fit <- getParents(
Scales2,
environment=NULL,
method = c("LINGAM"),
onlyObservationalData=TRUE,
pointConf = FALSE
)
View(buur.lingam.fit)
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = F,
EV = 1,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
#compare causal networks stability section
#LINGAM
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = F,
EV = 0.5,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = F,
EV = 1,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = T,
EV = 100,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
#LINGAM
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = T,
EV = 1,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
#compare causal networks stability section
#LINGAM
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = T,
EV = 2,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
#PC
buur.pc.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = T,
EV = 2,
nsim = 50,
onlyObservationalData = TRUE,
method = c("pc"),
verbose = FALSE
)
range(buur.pc.stable)
sum(as.logical(buur.pc.stable))
qgraph(buur.pc.stable)
buur.CCN.PC.stable.qgraph <-
qgraph(
buur.pc.stable,
layout = "spring",
labels = TRUE,
nodeNames = gsub("_", " ", colnames(Scales)),
legend.cex = 0.3,
groups = buur_groups,
palette = "ggplot2",
legend = TRUE,
legend.mode = "style1",
legend.cex = 0.32,
vsize = 3.8,
edge.labels = FALSE,
edge.label.cex = 0.4,
edge.label.bg = TRUE,
edge.label.position = 0.5,
weighted = FALSE,
layoutOffset = c(-.2, 0),
#GLratio=1.0,
filename = "buurPC_stabilitySelectionNodewise",
filetype = "pdf"
#minimum = 0.9
)
buur.lingam.fit[1:45]
useSamplestest <- sort(sample(c(1:nrow(Scales2)), round(length(c(1:nrow(Scales2))*0.7)))
)
sort(sample(1:313, round(length(1:313)*0.7)))
sample(1:10,7)
length(sort(sample(1:313, round(length(1:313)*0.7))))
#LINGAM
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = T,
sampleObservations = 0.5,
EV = 2,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
sqrt(2*(2*0.75-1))
sqrt(10*(2*0.75-1))
sqrt(15*(2*0.75-1))
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = T,
sampleObservations = 0.5,
EV = 15,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = T,
sampleObservations = 0.5,
EV = 30,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
sqrt(2*(2*0.75-1)*(32^2-32))
(32^2-32)
sqrt(2*(2*0.95-1)*(32^2-32))
sqrt(2*(2*0.75-1)*(32^2-32))
sqrt(500*(2*0.75-1)*(32^2-32))
sqrt(1*(2*0.75-1)*(32^2-32))
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = F,
sampleObservations = 0.5,
EV = 1,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
#LINGAM
buur.lingam.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
nodewise = F,
sampleObservations = 0.7,
EV = 0.1,
nsim = 50,
onlyObservationalData = TRUE,
method = c("LINGAM"),
setOptions = list(pointconf=FALSE),
verbose = FALSE
)
range(buur.lingam.stable)
sum(as.logical(buur.lingam.stable))
buur.pc.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
sampleObservations = 0.7,
nodewise = T,
EV = 2,
nsim = 50,
onlyObservationalData = TRUE,
method = c("pc"),
verbose = FALSE
)
range(buur.pc.stable)
sum(as.logical(buur.pc.stable))
buur.pc.stable <-
getParentsStable(
Scales2,
threshold = 0.75,
environment = NULL,
sampleObservations = 0.7,
nodewise = T,
EV = 2,
nsim = 100,
onlyObservationalData = TRUE,
method = c("pc"),
verbose = FALSE
)
range(buur.pc.stable)
sum(as.logical(buur.pc.stable))
buur.CCN.PC.stable.qgraph <-
qgraph(
buur.pc.stable,
layout = "spring",
labels = TRUE,
nodeNames = gsub("_", " ", colnames(Scales)),
legend.cex = 0.3,
groups = buur_groups,
palette = "ggplot2",
legend = TRUE,
legend.mode = "style1",
legend.cex = 0.32,
vsize = 3.8,
edge.labels = FALSE,
edge.label.cex = 0.4,
edge.label.bg = TRUE,
edge.label.position = 0.5,
weighted = FALSE,
layoutOffset = c(-.2, 0),
#GLratio=1.0,
filename = "buurPC_stabilitySelection",
filetype = "pdf"
#minimum = 0.9
)
ESS.PC.stable <-
getParentsStable(
MyData2,
threshold = 0.75,
environment = NULL,
sampleObservations = 0.7,
nodewise = T,
EV = 2,
nsim = 100,
onlyObservationalData = TRUE,
method = c("pc"),
verbose = FALSE
)
#### Load standardized data ####
MyData         <- readRDS("HandledData.rds")
longnames      <- readRDS("longnames.rds")
gr             <- readRDS("gr.rds")
namesRelabeled <- readRDS("namesRelabeled.rds")
MyData$countryLong <- NULL
MyData$country <- NULL
MyData2 <- MyData[!is.na(MyData)]
MyData2 <- na.omit(MyData)
ESS.lingam.stable <-
getParentsStable(
MyData2,
threshold = 0.75,
environment = NULL,
sampleObservations = 0.7,
nodewise = T,
EV = 2,
nsim = 100,
onlyObservationalData = TRUE,
method = c("LINGAM"),
verbose = FALSE
)
#plot ESS Lingam
ESS.lingam.qgraph <-
qgraph(
ESS.lingam.fit,
layout = "spring",
labels = namesRelabeled,
nodeNames = longnames,
legend.cex = 0.3,
groups = gr,
palette = "ggplot2",
legend = TRUE,
legend.mode = "style1",
legend.cex = 0.32,
vsize = 3.8,
edge.labels = FALSE,
edge.label.cex = 0.4,
edge.label.bg = TRUE,
edge.label.position = 0.5,
weighted = FALSE,
layoutOffset = c(-.2, 0),
filename = "ESS_LINGAM",
filetype = "pdf",
minimum = 0.1
)
#plot ESS Lingam
ESS.lingam.qgraph <-
qgraph(
ESS.lingam.stable,
layout = "spring",
labels = namesRelabeled,
nodeNames = longnames,
legend.cex = 0.3,
groups = gr,
palette = "ggplot2",
legend = TRUE,
legend.mode = "style1",
legend.cex = 0.32,
vsize = 3.8,
edge.labels = FALSE,
edge.label.cex = 0.4,
edge.label.bg = TRUE,
edge.label.position = 0.5,
weighted = FALSE,
layoutOffset = c(-.2, 0),
filename = "ESS_LINGAM",
filetype = "pdf",
minimum = 0.1
)
range(ESS.lingam.stable)
View(ESS.lingam.stable)
#plot ESS Lingam
ESS.lingam.qgraph <-
qgraph(
ESS.lingam.stable,
layout = "spring",
labels = namesRelabeled,
nodeNames = longnames,
legend.cex = 0.3,
groups = gr,
palette = "ggplot2",
legend = TRUE,
legend.mode = "style1",
legend.cex = 0.32,
vsize = 3.8,
edge.labels = FALSE,
edge.label.cex = 0.4,
edge.label.bg = TRUE,
edge.label.position = 0.5,
weighted = FALSE,
layoutOffset = c(-.2, 0),
filename = "ESS_LINGAM",
filetype = "pdf",
minimum = 99
)
#plot ESS Lingam
ESS.lingam.qgraph <-
qgraph(
ESS.lingam.stable,
layout = "spring",
labels = namesRelabeled,
nodeNames = longnames,
legend.cex = 0.3,
groups = gr,
palette = "ggplot2",
legend = TRUE,
legend.mode = "style1",
legend.cex = 0.32,
vsize = 3.8,
edge.labels = FALSE,
edge.label.cex = 0.4,
edge.label.bg = TRUE,
edge.label.position = 0.5,
weighted = FALSE,
layoutOffset = c(-.2, 0),
filename = "ESS_LINGAM",
filetype = "pdf",
minimum = 99
)
#plot ESS Lingam
ESS.lingam.qgraph <-
qgraph(
ESS.lingam.stable,
layout = "spring",
labels = namesRelabeled,
nodeNames = longnames,
legend.cex = 0.3,
groups = gr,
palette = "ggplot2",
legend = TRUE,
legend.mode = "style1",
legend.cex = 0.32,
vsize = 3.8,
edge.labels = FALSE,
edge.label.cex = 0.4,
edge.label.bg = TRUE,
edge.label.position = 0.5,
weighted = FALSE,
layoutOffset = c(-.2, 0),
filename = "ESS_LINGAM_stable",
filetype = "pdf",
minimum = 99
)
range(ESS.lingam.stable)
sum(as.logical(ESS.lingam.stable))
ESS.lingam.stable <-
getParentsStable(
MyData2,
threshold = 0.75,
environment = NULL,
sampleObservations = 0.7,
nodewise = T,
EV = 1,
nsim = 100,
onlyObservationalData = TRUE,
method = c("LINGAM"),
verbose = FALSE
)
range(ESS.lingam.stable)
sum(as.logical(ESS.lingam.stable))
ESS.PC.stable <-
getParentsStable(
MyData2,
threshold = 0.75,
environment = NULL,
sampleObservations = 0.7,
nodewise = T,
EV = 2,
nsim = 100,
onlyObservationalData = TRUE,
method = c("pc"),
verbose = FALSE
)
range(ESS.PC.stable)
sum(as.logical(ESS.PC.stable))
saveRDS(buur.pc.stable, "buur.pc.stable.RDS")
saveRDS(ESS.PC.stable, "ESS.pc.stable.RDS")
